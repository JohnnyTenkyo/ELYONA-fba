# 春节配置联动逻辑设计

## 需求分析

用户要求：如果备货总表中最晚发货日期正好处于春节不能发货期间，需要提前把发货量提前到最后一次发货时间，计划出货数量和时间需要跟春节配置的春节前最后一次出货时间和春节后最早一次出货时间联动。

## 实现方案

### 1. 春节配置数据结构
- holidayStartDate: 放假开始日期
- holidayEndDate: 放假结束日期
- lastShipDate: 春节前最后发货日期
- returnToWorkDate: 复工日期
- firstShipDate: 春节后最早出货日期

### 2. 发货计划调整逻辑

在计算发货计划时，需要检查：

1. **判断是否在春节期间**
   - 如果计划发货日期在 holidayStartDate 和 holidayEndDate 之间
   - 则该批次不能发货

2. **调整发货时间**
   - 如果计划发货日期 >= holidayStartDate 且 < firstShipDate
   - 则将该批次调整到 lastShipDate 发货
   - 或者调整到 firstShipDate 发货

3. **合并发货批次**
   - 如果多个批次都需要调整到同一天
   - 则合并这些批次的数量

### 3. 实现位置

需要在以下地方实现联动：

1. **ShippingPlan.tsx** - 发货计划页面
   - 在计算发货计划时考虑春节配置
   - 显示调整后的发货时间和数量

2. **FactoryPlan.tsx** - 工厂备货页面
   - 在计算备货需求时考虑春节因素
   - 提前备货以应对春节停工

3. **后端计算逻辑**
   - 在生成发货计划时自动应用春节调整
   - 确保数据一致性

### 4. UI提示

在发货计划中：
- 用特殊颜色标记受春节影响的批次
- 显示调整原因（如"春节前提前发货"）
- 显示原计划日期和调整后日期
